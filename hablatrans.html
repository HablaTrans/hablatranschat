<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Czat PL ↔ ES (DeepL + słownik logistyka)</title>
<style>
body{ font-family: Arial; margin:0; padding:20px; background:#f5f5f5;}
h2{ text-align:center; }

#chat{ display:flex; gap:20px; max-width:1000px; margin:auto; }

.panel{
  width:50%;
  background:white;
  border:1px solid #ddd;
  border-radius:8px;
  padding:10px;
  display:flex;
  flex-direction:column;
}

.messages{
  flex:1;
  border:1px solid #ccc;
  padding:8px;
  overflow:auto;
  margin-bottom:8px;
  background:#fafafa;
}

input{ width:75%; padding:6px; }
button{ padding:6px 10px; }

.msg{ margin:4px 0; }
.you{ font-weight:bold; }
.trans{ color:#444; font-style:italic; font-size:13px; }
</style>
</head>

<body>

<h2>Czat logistyczny Polski ↔ Hiszpański (DeepL)</h2>

<div id="chat">

  <div class="panel">
    <h3>Polski</h3>
    <div id="messagesA" class="messages"></div>
    <div>
      <input id="inputA" placeholder="Wpisz wiadomość...">
      <button onclick="sendA()">Wyślij</button>
    </div>
  </div>

  <div class="panel">
    <h3>Español</h3>
    <div id="messagesB" class="messages"></div>
    <div>
      <input id="inputB" placeholder="Escribe un mensaje...">
      <button onclick="sendB()">Enviar</button>
    </div>
  </div>

</div>

<script>
// ============================
// Wklej tutaj swój klucz DeepL
// ============================
const KEY = "288948c8-121b-42a2-afa1-a8f5d547a8e3:fx";

// ===== SŁOWNIK LOGISTYCZNY =====
const dictPLtoES = {
  "magazyn":"almacén",
  "przesyłka":"envío",
  "kontener":"contenedor",
  "załadunek":"carga",
  "rozładunek":"descarga",
  "transport":"transporte",
  "logistyka":"logística",
  "przewoźnik":"transportista",
  "dokumenty":"documentos",
  "paleta":"palé",
  "kierowca":"conductor"
};

const dictEStoPL = {};
for(let k in dictPLtoES){ dictEStoPL[dictPLtoES[k]] = k; }

// ===== DeepL tłumaczenie =====
async function translate(text, targetLang){

  let words = text.split(" ");
  let pre = words.map(w=>{
    if(targetLang==="ES") return dictPLtoES[w.toLowerCase()] || w;
    else return dictEStoPL[w.toLowerCase()] || w;
  }).join(" ");

  const params = new URLSearchParams();
  params.append("auth_key", KEY);
  params.append("text", pre);
  params.append("target_lang", targetLang);

  const res = await fetch("https://api-free.deepl.com/v2/translate", {
    method:"POST",
    body: params
  });

  const data = await res.json();
  return data.translations[0].text;
}

// ===== Funkcje wysyłania =====
async function sendA(){
  const input = document.getElementById("inputA");
  const text = input.value;
  if(!text) return;

  const a = document.getElementById("messagesA");
  const b = document.getElementById("messagesB");

  a.innerHTML += <div class="msg you">Ty: ${text}</div>;

  const t = await translate(text,"ES");
  b.innerHTML += <div class="msg trans">${t}</div>;

  a.scrollTop = a.scrollHeight;
  b.scrollTop = b.scrollHeight;
  input.value="";
}

async function sendB(){
  const input = document.getElementById("inputB");
  const text = input.value;
  if(!text) return;

  const a = document.getElementById("messagesA");
  const b = document.getElementById("messagesB");

  b.innerHTML += <div class="msg you">Tú: ${text}</div>;

  const t = await translate(text,"PL");
  a.innerHTML += <div class="msg trans">${t}</div>;

  a.scrollTop = a.scrollHeight;
  b.scrollTop = b.scrollHeight;
  input.value="";
}

// ===== Enter = wysyłanie =====
document.getElementById("inputA").addEventListener("keypress", function(e){
  if(e.key==="Enter") sendA();
});
document.getElementById("inputB").addEventListener("keypress", function(e){
  if(e.key==="Enter") sendB();
});

</script>

</body>
</html>